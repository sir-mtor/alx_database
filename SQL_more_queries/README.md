More on SQL
this is quite complex to understand but i will try my best :(